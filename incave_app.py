# -*- coding: utf-8 -*-
import streamlit as st
import pandas as pd # ‡∏ú‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏° import pandas ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÑ‡∏ß‡πâ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏Ñ‡∏£‡∏±‡∏ö

print("DEBUG 1: Script started, imports successful.")

# --- ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç) ---
# ‡πÉ‡∏ä‡πâ cache ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Ñ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏õ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô
@st.cache_data
def get_quiz_data():
    """
    ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°, ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å, ‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
    """
    questions = [
        {"question": "1. ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì", "options": {"A": "‡∏ú‡∏≠‡∏° ‡πÅ‡∏´‡πâ‡∏á ‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô", "B": "‡∏™‡∏°‡∏™‡πà‡∏ß‡∏ô ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡∏°‡∏µ‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠", "C": "‡∏≠‡πâ‡∏ß‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏ç‡πà ‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏ô‡πà‡∏ô", "D": "‡∏ú‡∏¥‡∏ß‡πÅ‡∏î‡∏á ‡∏Ç‡∏µ‡πâ‡∏£‡πâ‡∏≠‡∏ô ‡∏°‡∏µ‡πÄ‡∏´‡∏á‡∏∑‡πà‡∏≠‡∏ö‡πà‡∏≠‡∏¢"}},
        {"question": "2. ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì", "options": {"A": "‡∏ä‡∏≠‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏£‡∏™‡∏à‡∏±‡∏î ‡πÄ‡∏ú‡πá‡∏î ‡πÄ‡∏Ñ‡πá‡∏°", "B": "‡∏Å‡∏¥‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡∏≠‡∏¢‡∏π‡πà‡∏á‡πà‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏°‡∏≤‡∏Å", "C": "‡∏ä‡∏≠‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏°‡∏±‡∏ô ‡∏´‡∏ß‡∏≤‡∏ô ‡πÅ‡∏õ‡πâ‡∏á", "D": "‡∏´‡∏¥‡∏ß‡∏ö‡πà‡∏≠‡∏¢ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô‡∏à‡∏∞‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î"}},
        {"question": "3. ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô", "options": {"A": "‡∏´‡∏•‡∏±‡∏ö‡∏¢‡∏≤‡∏Å ‡∏´‡∏•‡∏±‡∏ö‡πÑ‡∏°‡πà‡∏•‡∏∂‡∏Å", "B": "‡∏ô‡∏≠‡∏ô‡∏ô‡∏≤‡∏ô ‡∏ï‡∏∑‡πà‡∏ô‡∏¢‡∏≤‡∏Å", "C": "‡∏á‡πà‡∏ß‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡∏ô‡∏≠‡∏ô‡∏ö‡πà‡∏≠‡∏¢", "D": "‡∏ï‡∏∑‡πà‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏î‡∏∂‡∏Å ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏£‡πâ‡∏≠‡∏ô"}},
        {"question": "4. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≠‡∏ö‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏Å‡∏≤‡∏®", "options": {"A": "‡∏ä‡∏≠‡∏ö‡∏•‡∏°‡∏û‡∏±‡∏î ‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏ñ‡πà‡∏≤‡∏¢‡πÄ‡∏ó", "B": "‡∏ä‡∏≠‡∏ö‡πÄ‡∏¢‡πá‡∏ô‡∏™‡∏ö‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡∏£‡πâ‡∏≠‡∏ô‡πÑ‡∏°‡πà‡∏´‡∏ô‡∏≤‡∏ß", "C": "‡πÅ‡∏û‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏¢‡πá‡∏ô ‡∏´‡∏ô‡∏≤‡∏ß‡∏á‡πà‡∏≤‡∏¢", "D": "‡∏£‡πâ‡∏≠‡∏ô‡∏ö‡πà‡∏≠‡∏¢ ‡πÄ‡∏´‡∏á‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å‡∏á‡πà‡∏≤‡∏¢"}},
        {"question": "5. ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß", "options": {"A": "‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡πÑ‡∏ß ‡∏ä‡∏≠‡∏ö‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡πá‡∏ß", "B": "‡∏ä‡πâ‡∏≤‡πÅ‡∏ï‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡πÑ‡∏°‡πà‡∏£‡∏µ‡∏ö‡∏£‡πâ‡∏≠‡∏ô", "C": "‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏ô‡πâ‡∏≠‡∏¢", "D": "‡∏Å‡∏£‡∏∞‡∏™‡∏±‡∏ö‡∏Å‡∏£‡∏∞‡∏™‡πà‡∏≤‡∏¢ ‡∏Ç‡∏¢‡∏±‡∏ô‡πÅ‡∏ï‡πà‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î"}},
        {"question": "6. ‡∏™‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï‡πÉ‡∏à/‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå", "options": {"A": "‡∏Ñ‡∏¥‡∏î‡∏°‡∏≤‡∏Å ‡∏´‡∏ß‡∏±‡πà‡∏ô‡πÑ‡∏´‡∏ß‡∏á‡πà‡∏≤‡∏¢", "B": "‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡πÄ‡∏¢‡∏∑‡∏≠‡∏Å‡πÄ‡∏¢‡πá‡∏ô ‡πÉ‡∏à‡∏î‡∏µ", "C": "‡∏≠‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß ‡∏Ç‡∏µ‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡πÉ‡∏à", "D": "‡∏Ç‡∏µ‡πâ‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏£‡πâ‡∏≠‡∏ô"}},
        {"question": "7. ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡πá‡∏ö‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏ö‡πà‡∏≠‡∏¢", "options": {"A": "‡∏õ‡∏ß‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢ ‡∏•‡∏°‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏¢‡∏≠‡∏∞", "B": "‡∏õ‡∏ß‡∏î‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏ô‡∏±‡∏Å‡πÜ", "C": "‡∏ö‡∏ß‡∏°‡∏ô‡πâ‡∏≥ ‡∏õ‡∏±‡∏™‡∏™‡∏≤‡∏ß‡∏∞‡∏ö‡πà‡∏≠‡∏¢", "D": "‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏Ç‡πâ ‡∏ï‡∏±‡∏ß‡∏£‡πâ‡∏≠‡∏ô ‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß‡∏ö‡πà‡∏≠‡∏¢"}}
    ]
    element_map = {'A': '‡∏•‡∏°', 'B': '‡∏î‡∏¥‡∏ô', 'C': '‡∏ô‡πâ‡∏≥', 'D': '‡πÑ‡∏ü'}
    results_guide = {
        '‡∏•‡∏°': {'description': '‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡πÑ‡∏ß ‡∏≠‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏á‡πà‡∏≤‡∏¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏¢‡∏≠‡∏∞', 'behavior': '‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏™‡∏°‡∏≤‡∏ò‡∏¥ ‡πÄ‡∏î‡∏¥‡∏ô‡∏õ‡πà‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏•‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏•', 'herbs': '‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏¥‡∏á, ‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢, ‡∏Å‡∏£‡∏∞‡∏ä‡∏≤‡∏¢ ‚Äì ‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡∏Ç‡∏±‡∏ö‡∏•‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô'},
        '‡∏î‡∏¥‡∏ô': {'description': '‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô ‡πÅ‡∏ï‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏ä‡πâ‡∏≤', 'behavior': '‡∏Ñ‡∏ß‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏¥‡πà‡∏á‡∏à‡πá‡∏≠‡∏Å‡∏Å‡∏¥‡πâ‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏¢‡∏Ñ‡∏∞‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠', 'herbs': '‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ö‡∏¢‡πà‡∏≤‡∏ô‡∏≤‡∏á, ‡∏°‡∏∞‡∏£‡∏∏‡∏° ‚Äì ‡∏ä‡πà‡∏ß‡∏¢‡∏Ç‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ú‡∏≤‡∏ú‡∏•‡∏≤‡∏ç'},
        '‡∏ô‡πâ‡∏≥': {'description': '‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏•‡πà‡∏≠‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á ‡∏°‡∏µ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏≠‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß ‡∏á‡πà‡∏ß‡∏á‡∏á‡πà‡∏≤‡∏¢', 'behavior': '‡∏Ñ‡∏ß‡∏£‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ä‡πâ‡∏≤‡∏£‡∏±‡∏ö‡πÅ‡∏î‡∏î ‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏¥‡∏°‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥ ‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏¢‡πá‡∏ô/‡∏´‡∏ß‡∏≤‡∏ô', 'herbs': '‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏∞‡πÑ‡∏Ñ‡∏£‡πâ, ‡∏ö‡∏±‡∏ß‡∏ö‡∏Å, ‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö ‚Äì ‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ß‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô'},
        '‡πÑ‡∏ü': {'description': '‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ú‡∏≤‡∏ú‡∏•‡∏≤‡∏ç ‡πÄ‡∏£‡πà‡∏≤‡∏£‡πâ‡∏≠‡∏ô ‡∏°‡∏µ‡∏û‡∏•‡∏±‡∏á‡∏™‡∏π‡∏á ‡πÅ‡∏ï‡πà‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î‡∏á‡πà‡∏≤‡∏¢', 'behavior': '‡∏Ñ‡∏ß‡∏£‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏î‡∏î‡∏à‡∏±‡∏î ‡∏ù‡∏∂‡∏Å‡∏™‡∏°‡∏≤‡∏ò‡∏¥ ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏¢‡πá‡∏ô‡∏™‡∏ö‡∏≤‡∏¢', 'herbs': '‡πÄ‡∏ä‡πà‡∏ô ‡∏ü‡πâ‡∏≤‡∏ó‡∏∞‡∏•‡∏≤‡∏¢‡πÇ‡∏à‡∏£, ‡∏£‡∏≤‡∏á‡∏à‡∏∑‡∏î, ‡πÅ‡∏ï‡∏á‡∏Å‡∏ß‡∏≤ ‚Äì ‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏§‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏¢‡πá‡∏ô‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÉ‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢'}
    }
    return questions, element_map, results_guide

# --- ‡∏™‡πà‡∏ß‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢) ---
def analyze_and_display_results(scores, results_guide):
    """
    ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏°‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏´‡∏≤‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡πà‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
    """
    if not scores:
        st.error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô")
        return

    max_score = max(scores.values())
    top_elements = [element for element, score in scores.items() if score == max_score]
    
    st.balloons()
    st.header("üßæ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:")

    # ‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡πà‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô
    if len(top_elements) > 1:
        elements_str = " ‡πÅ‡∏•‡∏∞ ".join(top_elements)
        st.subheader(f"üîπ ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠: ‡∏ò‡∏≤‡∏ï‡∏∏{elements_str}!")
        st.info("‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏ò‡∏≤‡∏ï‡∏∏‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏á‡∏ï‡∏±‡∏ß ‡∏•‡∏≠‡∏á‡∏î‡∏π‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì:")
        for element in top_elements:
            result = results_guide[element]
            st.markdown(f"---")
            st.markdown(f"### üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ò‡∏≤‡∏ï‡∏∏ {element}")
            st.markdown(f"**‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:** {result['description']}")
            st.markdown(f"**‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°:** {result['behavior']}")
            st.markdown(f"**‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£:** {result['herbs']}")
    # ‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡πà‡∏ô‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
    else:
        primary_element = top_elements[0]
        result = results_guide[primary_element]
        st.subheader(f"üîπ ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ ‚Äú‡∏ò‡∏≤‡∏ï‡∏∏‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‚Äù ‡∏Ñ‡∏∑‡∏≠: {primary_element}")
        st.markdown(f"---")
        st.markdown(f"### üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏≤‡∏ï‡∏∏ {primary_element}:")
        # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Key ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á
        st.markdown(f"**‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:** {result['description']}")
        st.markdown(f"**‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°:** {result['behavior']}")
        st.markdown(f"**‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£:** {result['herbs']}")

print("DEBUG 2: Functions defined.")

# --- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏±‡∏ö Input) ---

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
st.title("‡∏ñ‡πâ‡∏≥‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå AI: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì üåø")
print("DEBUG 3: App title is set.")

st.write("‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á")

# ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
questions, element_map, results_guide = get_quiz_data()

# ‡∏™‡∏£‡πâ‡∏≤‡∏á Form ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏î‡∏™‡πà‡∏á
with st.form("quiz_form"):
    user_answers = []
    st.info("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠")
    
    for i, q_data in enumerate(questions):
        st.subheader(f"‚ùì {q_data['question']}")
        
        # *** ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ***
        # ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏™‡πà‡∏á key ('A', 'B', 'C', 'D') ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á
        # ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡πá‡∏°‡πÜ ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡πá‡∏ô
        answer = st.radio(
            "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö:",
            options=q_data['options'].keys(),  # ‡∏™‡πà‡∏á‡πÅ‡∏Ñ‡πà Key ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ
            format_func=lambda key: f"{key}: {q_data['options'][key]}", # ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            key=f"q{i}"
        )
        user_answers.append(answer) # ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô 'A', 'B', 'C', 'D' ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á

    # ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
    submitted = st.form_submit_button("‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå")

# ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå"
if submitted:
    # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
    scores = {'‡∏•‡∏°': 0, '‡∏î‡∏¥‡∏ô': 0, '‡∏ô‡πâ‡∏≥': 0, '‡πÑ‡∏ü': 0}
    for answer_key in user_answers:
        element = element_map[answer_key]
        scores[element] += 1
    
    # ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    analyze_and_display_results(scores, results_guide)

print("DEBUG 4: End of script, app should be running.")
